!function(t){"use strict";var e=function(t,o){if(!t||0===t.length)throw new Error("Empty collection!");var i=this;if(this.collection=[],t.forEach(function(t){i.collection.push({item:t})}),o=o||{},this.delimiter=o.delimiter||e.defaultOptions.delimiter,this.maxFilterTokenEntries=o.maxFilterTokenEntries||e.defaultOptions.maxFilterTokenEntries,this.defaultThreshold=o.threshold||e.defaultOptions.threshold,this.collectionKeys=o.collectionKeys||e.defaultOptions.collectionKeys,this.searchAlgorithm=o.searchAlgorithm||e.defaultOptions.searchAlgorithm,this.sortAlgorithm=o.sortAlgorithm||e.defaultOptions.sortAlgorithm,this.postprocessAlgorithm=o.postprocessAlgorithm||e.defaultOptions.postprocessAlgorithm,0===this.collectionKeys.length)throw new Error("No collectionKeys defined!");this.collectionDataTokenSize=this.collectionKeys.length,this._prepareSearchTokens()};e.defaultOptions={delimiter:/[\s-_]+/,threshold:.7,maxFilterTokenEntries:5,collectionKeys:[],searchAlgorithm:function(t,e){for(var o=0,i=e.length,r=0;i>r;r++){var n=e[r],s=t.indexOf(n);s>-1&&(o+=t===n?6:0===s?2:1)}return o},postprocessAlgorithm:function(t,e,o){var i=1/e,r=[];return t.forEach(function(t){t.score=1-t.score*i,t.score<=o&&r.push(t)}),r},sortAlgorithm:function(t){return t.sort(function(t,e){return t.score-e.score})}},e.prototype._prepareSearchTokens=function(){var t=this;this.collection.forEach(function(e){var o=[];t.collectionKeys.forEach(function(i){e.item[i].trim().toLowerCase().split(t.delimiter).forEach(function(t){o=o.concat(t)})}),e.dataEntryTokens=o.filter(t._onlyUnique)})},e.prototype._onlyUnique=function(t,e,o){return o.indexOf(t)===e},e.prototype.search=function(t,e){for(var o=[],i=e||this.defaultThreshold,r=this,n=t.trim().split(this.delimiter).filter(this._onlyUnique),s=0,l=Math.min(n.length,this.maxFilterTokenEntries);l>s;s++)o.push(n[s].toLowerCase());var c=[],h=0;this.collection.forEach(function(t){var e=0;t.dataEntryTokens.forEach(function(t){e+=r.searchAlgorithm(t,o)}),e&&(e>h&&(h=e),c.push({item:t.item,score:e}))});var a=r.postprocessAlgorithm(c,h,i);return r.sortAlgorithm(a)},"object"==typeof exports?module.exports=e:"function"==typeof define&&define.amd?define(function(){return e}):t.Tokensearch=e}(this);